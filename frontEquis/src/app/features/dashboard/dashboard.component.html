<div class="dashboard-container">
    <!-- Sidebar Desktop -->
    <aside class="sidebar">
        <div class="brand">
            <span class="logo-text">Naranja<span>Equis</span></span>
        </div>
        <nav>
            <a routerLink="/dashboard" class="active"><i class="fa-solid fa-house"></i> Inicio</a>
            <a routerLink="/dashboard"><i class="fa-solid fa-credit-card"></i> Mis Tarjetas</a>
            <a routerLink="/dashboard"><i class="fa-solid fa-user"></i> Mi Perfil</a>
            <a routerLink="/dashboard"><i class="fa-solid fa-shield-halved"></i> Seguridad</a>
        </nav>
        <button class="logout-btn" (click)="logout()">
            <i class="fa-solid fa-right-from-bracket"></i> Cerrar SesiÃ³n
        </button>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="content-wrapper">
            <header class="top-header">
                <h1 class="welcome-text">Hola, {{ user?.firstName }}! ðŸ‘‹</h1>
                <div class="date-display">{{ today | date:'EEEE, d MMMM':'-0300' }}</div>
            </header>

            <div class="dashboard-grid">
                <!-- Balance Section -->
                <div class="balance-card">
                    <span class="label">SALDO DISPONIBLE</span>
                    <h2 class="amount">{{ wallet?.balance | currency:'ARS':'symbol':'1.2-2' }}</h2>
                    <div class="cvu-info">
                        <span>CVU: {{ wallet?.cvu }}</span>
                        <i class="fa-regular fa-copy"></i>
                    </div>

                    <div class="actions">
                        <button class="btn-main btn-orange" (click)="showDepositModal = true">
                            <i class="fa-solid fa-plus"></i> Ingresar
                        </button>
                        <button class="btn-main btn-glass" (click)="showTransferModal = true">
                            <i class="fa-solid fa-paper-plane"></i> Transferir
                        </button>
                    </div>
                </div>

                <!-- Transaction Section -->
                <div class="history-card">
                    <h2 class="section-title">Ãšltimos Movimientos</h2>
                    <div class="transaction-list">
                        <div *ngFor="let tx of transactions" class="tx-item">
                            <div class="tx-icon" [ngClass]="getTransactionIconClass(tx)">
                                <i [class]="getTransactionIcon(tx)"></i>
                            </div>
                            <div class="tx-details">
                                <p class="tx-title">{{ getTransactionTitle(tx) }}</p>
                                <p class="tx-date">{{ tx.createdAt | date:'dd/MM/yy HH:mm':'-0300' }}</p>
                            </div>
                            <div class="tx-amount" [ngClass]="getAmountClass(tx)">
                                {{ isPositive(tx) ? '+' : '-' }}{{ tx.amount | currency:'ARS':'symbol':'1.2-2' }}
                            </div>
                        </div>

                        <div *ngIf="transactions.length === 0" class="empty-state">
                            <p>AÃºn no hay movimientos</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Mobile Navigation Bar -->
    <nav class="mobile-nav-bar">
        <a routerLink="/dashboard" class="mobile-nav active"><i class="fa-solid fa-house"></i> Inicio</a>
        <a routerLink="/dashboard" class="mobile-nav"><i class="fa-solid fa-credit-card"></i> Mis Tarjetas</a>
        <a routerLink="/dashboard" class="mobile-nav"><i class="fa-solid fa-user"></i> Mi Perfil</a>
        <a routerLink="/login" class="mobile-nav" (click)="logout()"><i class="fa-solid fa-right-from-bracket"></i>
            Salir</a>
    </nav>

    <!-- Modals -->
    <!-- Ingresar Dinero Overlay -->
    <div class="modal-backdrop" *ngIf="showDepositModal" (click)="showDepositModal = false">
        <div class="modal-content" (click)="$event.stopPropagation()">
            <h3>Ingresar Dinero</h3>
            <div class="form-group">
                <label>Â¿CuÃ¡nto quieres ingresar?</label>
                <input type="number" [(ngModel)]="amount" placeholder="0.00" autoFocus>
            </div>
            <div class="modal-footer">
                <button class="btn-confirm" (click)="onDeposit()" [disabled]="amount <= 0">Confirmar Ingreso</button>
                <button class="btn-cancel" (click)="showDepositModal = false">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Transferir Dinero Overlay -->
    <div class="modal-backdrop" *ngIf="showTransferModal" (click)="showTransferModal = false">
        <div class="modal-content" (click)="$event.stopPropagation()">
            <h3>Transferir Dinero</h3>
            <div class="form-group">
                <label>Monto</label>
                <input type="number" [(ngModel)]="amount" placeholder="0.00" autoFocus>
            </div>
            <div class="form-group">
                <label>Billetera Destino (CVU o Alias)</label>
                <input type="text" [(ngModel)]="targetWalletId" placeholder="Escribe el CVU o Alias">
            </div>
            <div class="modal-footer">
                <button class="btn-confirm" (click)="onTransfer()"
                    [disabled]="amount <= 0 || !targetWalletId">Transferir</button>
                <button class="btn-cancel" (click)="showTransferModal = false">Cancelar</button>
            </div>
        </div>
    </div>
</div>